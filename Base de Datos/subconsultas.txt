--Subconsultas en la clausura WHERE
--Permite establecer una condicion usando datos de otra tabla
--sin necesidad de hacer equijoin.
--Los datos de la subconsulta pueden ser una fila o conjunto de filas

--Todas las peliculas de Paramount Pictures

SELECT m.*
FROM movies m. studios s
WHERE m.studio_id=s.studio_id
AND s.name='Paramount Pictures';

--Lo mismo mediante una subconsulta que devuleve una fila

SELECT *
FROM movies
WHERE studio_id=(
	SELECT studio_id
	FROM studios
	WHERE name='Paramount Pictures'
);

--Todas las peliculas dirigidas por clint Eastwood

SELECT *
FROM movies
WHERE director_id=(
	SELECT artist_id
	FROM artists
	WHERE name='Clint Eastwood'
);



-- Todos los datos de las peliculas donde actua al pacino

SELECT *
FROM movies
WHERE movie_id IN (
	SELECT movie_id
	FROM art_mov
	WHERE artist_id=(
		SELECT artist_id
		FROM artists
		WHERE name='Al Pacino'
		)
);

--Cuando la subconsulta devuelve varias filas no se puede usar
--el operador = y se usa en su lugar el operador IN

--Todos los datos del director de Million dollar baby

SELECT *
FROM movies
WHERE movie_id IN (
	SELECT movie_id
	FROM art_mov
	WHERE artist_id=(
		SELECT artist_id
		FROM artists
		
		)
);
